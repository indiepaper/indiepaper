<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

        <%= csrf_meta_tag() %>
        <%= live_title_tag assigns[:page_title] || "IndiePaper", suffix: " · IndiePaper" %>

        <%= if assigns[:meta_attrs], do: meta_tags(assigns[:meta_attrs]) %>

        <link phx-track-static rel="stylesheet" href={Routes.static_path(@conn, "/assets/app.css")}/>
        <link phx-track-static rel="stylesheet" href={Routes.static_path(@conn, "/assets/fonts/fonts.css")}/>
        <script defer type="module" phx-track-static type="text/javascript" src={Routes.static_path(@conn, "/assets/js/app.js")}></script>
        <script defer data-domain="indiepaper.me" src="https://plausible.io/js/plausible.js"></script>
    </head>

    <body class="flex flex-col h-screen antialiased text-gray-800 item-stretch md:text-primary-text">
        <header class="border-b-2 border-orange-400">
            <div class="flex flex-row justify-between items-center container-box">
                <%= link "IndiePaper", to: Routes.page_path(@conn, :index), class: "font-bold", "data-test": "title"  %>
                <div class="flex flex-row items-center space-x-4">
                    <%= if @current_author do %>
                        <%= live_redirect "Dashboard", to: Routes.dashboard_path(@conn, :index), class: "primary-link" %>
                        <div x-data="{profileOpen: false}" class="relative ml-3">
                            <div>
                                <button data-test="navbar-profile" @click="profileOpen = !profileOpen" type="button" class="flex items-center max-w-xs text-sm bg-gray-800 rounded-full ring-2 ring-white ring-offset-2 ring-offset-gray-800 focus:outline-none" id="user-menu-button" aria-expanded="false" aria-haspopup="true">
                                    <span class="sr-only">Open user menu</span>
                                    <img class="w-8 h-8 rounded-full" src={IndiePaper.ExternalAssetHandler.get_public_url(@current_author.profile_picture)} alt="">
                                </button>
                            </div>
                            <div
                                @click.outside="profileOpen = false"
                                x-cloak
                                x-show="profileOpen"
                                x-transition:enter="transition ease-out duration-100"
                                x-transition:enter-start="transform opacity-0 scale-95"
                                x-transition:enter-end="transform opacity-100 scale-100"
                                x-transition:leave="transition ease-in duration-75"
                                x-transition:leave-start="transform opacity-100 scale-100"
                                x-transition:leave-end="transform opacity-0 scale-95"
                                class="absolute right-0 z-50 py-1 mt-2 w-64 bg-white rounded-md ring-1 ring-black ring-opacity-5 shadow-lg origin-top-right focus:outline-none" role="menu" aria-orientation="vertical" aria-labelledby="user-menu-button" tabindex="-1">
                                <%= live_redirect to: Routes.author_page_path(@conn, :show, @current_author), class: "block flex flex-col items-start py-3 px-6 space-y-0 !space-x-0 hover:bg-stone-100 primary-link" do %>
                                    <p>Signed in as</p>
                                    <div class="flex flex-row items-center space-x-1">
                                        <p class="font-semibold"><%= IndiePaper.Authors.get_full_name(@current_author) %></p>
                                        <div>
                                            <svg xmlns="http://www.w3.org/2000/svg" class="block w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
                                            </svg>
                                        </div>
                                    </div>
                                <% end %>
                                <%= live_redirect to: Routes.dashboard_library_path(@conn, :index), class: "block flex flex-row items-center py-3 px-6 space-x-3 border-t hover:bg-stone-100 border-secondary-border primary-link" do %>
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-5 h-5 fill-current"><path fill="none" d="M0 0h24v24H0z"/><path d="M3 18.5V5a3 3 0 0 1 3-3h14a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5A3.5 3.5 0 0 1 3 18.5zM19 20v-3H6.5a1.5 1.5 0 0 0 0 3H19zM5 15.337A3.486 3.486 0 0 1 6.5 15H19V4H6a1 1 0 0 0-1 1v10.337z"/></svg>
                                    <p>Library</p>
                                <% end %>
                                <%= live_redirect to: Routes.settings_profile_path(@conn, :edit), class: "block flex flex-row items-center py-3 px-6 space-x-3 border-t hover:bg-stone-100 primary-link border-secondary-border" do %>
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-5 h-5 fill-current"><path fill="none" d="M0 0h24v24H0z"/><path d="M2 3.993A1 1 0 0 1 2.992 3h18.016c.548 0 .992.445.992.993v16.014a1 1 0 0 1-.992.993H2.992A.993.993 0 0 1 2 20.007V3.993zM4 5v14h16V5H4zm2 2h6v6H6V7zm2 2v2h2V9H8zm-2 6h12v2H6v-2zm8-8h4v2h-4V7zm0 4h4v2h-4v-2z"/></svg>
                                    <p>Profile</p>
                                <% end %>
                                <%= link to: Routes.author_settings_path(@conn, :edit), class: "block flex flex-row items-center py-3 px-6 space-x-3 hover:bg-stone-100 primary-link" do %>
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-5 h-5 fill-current"><path fill="none" d="M0 0h24v24H0z"/><path d="M2.213 14.06a9.945 9.945 0 0 1 0-4.12c1.11.13 2.08-.237 2.396-1.001.317-.765-.108-1.71-.986-2.403a9.945 9.945 0 0 1 2.913-2.913c.692.877 1.638 1.303 2.403.986.765-.317 1.132-1.286 1.001-2.396a9.945 9.945 0 0 1 4.12 0c-.13 1.11.237 2.08 1.001 2.396.765.317 1.71-.108 2.403-.986a9.945 9.945 0 0 1 2.913 2.913c-.877.692-1.303 1.638-.986 2.403.317.765 1.286 1.132 2.396 1.001a9.945 9.945 0 0 1 0 4.12c-1.11-.13-2.08.237-2.396 1.001-.317.765.108 1.71.986 2.403a9.945 9.945 0 0 1-2.913 2.913c-.692-.877-1.638-1.303-2.403-.986-.765.317-1.132 1.286-1.001 2.396a9.945 9.945 0 0 1-4.12 0c.13-1.11-.237-2.08-1.001-2.396-.765-.317-1.71.108-2.403.986a9.945 9.945 0 0 1-2.913-2.913c.877-.692 1.303-1.638.986-2.403-.317-.765-1.286-1.132-2.396-1.001zM4 12.21c1.1.305 2.007 1.002 2.457 2.086.449 1.085.3 2.22-.262 3.212.096.102.195.201.297.297.993-.562 2.127-.71 3.212-.262 1.084.45 1.781 1.357 2.086 2.457.14.004.28.004.42 0 .305-1.1 1.002-2.007 2.086-2.457 1.085-.449 2.22-.3 3.212.262.102-.096.201-.195.297-.297-.562-.993-.71-2.127-.262-3.212.45-1.084 1.357-1.781 2.457-2.086.004-.14.004-.28 0-.42-1.1-.305-2.007-1.002-2.457-2.086-.449-1.085-.3-2.22.262-3.212a7.935 7.935 0 0 0-.297-.297c-.993.562-2.127.71-3.212.262C13.212 6.007 12.515 5.1 12.21 4a7.935 7.935 0 0 0-.42 0c-.305 1.1-1.002 2.007-2.086 2.457-1.085.449-2.22.3-3.212-.262-.102.096-.201.195-.297.297.562.993.71 2.127.262 3.212C6.007 10.788 5.1 11.485 4 11.79c-.004.14-.004.28 0 .42zM12 15a3 3 0 1 1 0-6 3 3 0 0 1 0 6zm0-2a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/></svg>
                                    <p>Settings</p>
                                <% end %>
                                <%= link to: Routes.author_session_path(@conn, :delete), method: :delete, class: "primary-link flex flex-row space-x-3 block border-t border-secondary-border py-3 px-6 hover:bg-stone-100", "data-no-instant": true, role: "menuitem"  do %>
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                                    </svg>
                                    <p>Sign out</p>
                                <% end %>
                            </div>
                        </div>
                    <% else %>
                        <div class="flex flex-row items-center space-x-4">
                            <%= link "Sign in", to: Routes.author_session_path(@conn, :new) , class: "primary-link"%>
                            <%= link to: Routes.author_registration_path(@conn, :new), class: "secondary-button text-sm" do  %>
                                <span>Start Writing</span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 1.414L10.586 9H7a1 1 0 100 2h3.586l-1.293 1.293a1 1 0 101.414 1.414l3-3a1 1 0 000-1.414z" clip-rule="evenodd" />
                                </svg>
                            <% end %>
                        </div>
                    <% end %>
                </div>
            </div>
        </header>
        <%= @inner_content %>
        <footer class="font-normal bg-white border-t border-b border-primary-border">
            <div class="flex flex-col justify-between items-start py-8 space-y-8 md:flex-row md:space-y-0 container-box">
                <div class="flex flex-col items-start space-y-4 md:space-y-8">
                    <div class="flex flex-row space-x-2">
                        <a href="https://twitter.com/indiepaperme" class="secondary-link">
                            <svg class="w-4 h-4 fill-current" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                                <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path>
                            </svg>
                            <span>
                                twitter
                            </span>
                        </a>
                        <a class="secondary-link" href="mailto:support@indiepaper.me">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M2.94 6.412A2 2 0 002 8.108V16a2 2 0 002 2h12a2 2 0 002-2V8.108a2 2 0 00-.94-1.696l-6-3.75a2 2 0 00-2.12 0l-6 3.75zm2.615 2.423a1 1 0 10-1.11 1.664l5 3.333a1 1 0 001.11 0l5-3.333a1 1 0 00-1.11-1.664L10 11.798 5.555 8.835z" clip-rule="evenodd" />
                            </svg>
                            <span>
                                support@indiepaper.me
                            </span>
                        </a>
                    </div>
                    <div class="flex flex-row items-center space-x-1">
                        <a class="inline-block secondary-link" href="/privacy-policy">
                            <p>
                                Privacy
                            </p>
                        </a>
                        <a class="inline-block secondary-link" href="/terms-of-service">
                            Terms of Service
                        </a>
                    </div>
                </div>
                <div class="text-sm font-medium">
                    <p class="">IndiePaper, Inc. © 2021</p>
                </div>
            </div>
        </footer>
    </body>
</html>
